/*!
 * app.js Javascript Library v0.9
 *
 * Copyright (c) 2011 Fabian Irsara
 * Licensed under the GPL Version 2 licenses.
 * 
 * Provides prototypal inheritence of self-defined Classes
 * Parsing Classes
 * Requiring, extending Classes
 * including Plugins and Stylesheets Dynamically
 */var app=function(a,b){"use strict";a.VERSION=.9;a.NAME="app";a.MINIFY_JS=!1;a.CACHE=!1;a.BASE_PATH="";a.DEFINES_CLASSES=!0;var c=[],d={},e=0,f=function(){this.self=this;this.priv={}},g,h,i,j,k,l,m,n,o;a.Class=function(a){this.className="";this.classConstructor=null;this.superClass="Class";this.imports=[];this.plugins=[];this.callback=null;this.skipImports=!1;for(var b in a)b!=="indexOf"&&(this[b]=a[b])};a.ignore=function(a){c[a]=!0};a.run=function(a,b){h(a,b,null,!0)};a.style=function(b,c){b=b.trim();var d=b;!b.endsWith(".css")&&a.BASE_PATH!==""&&(b=a.BASE_PATH+b+".css");if(!a.CACHE){b.indexOf("?")!==-1?b+="&":b+="?";b+="t="+(new Date).getTime()}if(i("link",{"data-includemodule":d})){c&&c.call(a,null);return}j("link",{"class":"style-includemodule","data-includemodule":d,rel:"stylesheet",type:"text/css",charset:"utf-8",href:b})};a.remove=function(b,e,f){b instanceof Array||(b=[b]);e===null&&(e=!0);f===null&&(f=!1);var g,h,j,k;for(j=0;j<b.length;j++){h=b[j].trim();if(c[h]===!0)continue;g=i("script",{"data-includemodule":h});g&&g.parentNode.removeChild(g);if(!d[h])continue;if(e&&d[h].imports)for(k=0;k<d[h].imports.length;k++)a.remove(d[h].imports[k]);if(f&&d[h].plugins)for(k=0;k<d[h].plugins.length;k++)a.remove(d[h].plugins[k]);d[h]=null}};a.requires=function(a,b,c){a instanceof Array||(a=[a]);var e,f,g=-1;e=function(){g++;a[g]&&h(a[g],e,f)};f=function(){c&&c(a[g]);d[a[g]]||(d[a[g]]={});d[a[g]].ready=!0;e()};e();b&&k(a,b)};a.defineClass=function(b){d[b.className]||(d[b.className]=b);for(var c=0;c<d[b.className].plugins.length;c++)d[b.className].imports.push(d[b.className].plugins[c]);d[b.className].loadID=e;d[b.className].size=b.imports.length;d[b.className].skipImports===!0&&a.ignore(b.className);d[b.className].size>0&&a.requires(d[b.className].imports);e++;m(b.className)};var p=Object.prototype.hasOwnProperty;a.__extend=function(a,b){function f(){this.constructor=a;this.self=this}var c={prototypes:{},statics:{}},d;for(d in a)c.statics[d]=a[d];for(d in a.prototype)c.prototypes[d]=a.prototype[d];for(var e in b)p.call(b,e)&&(a[e]=b[e]);f.prototype=b.prototype;a.prototype=new f;a.__super__=b.prototype;for(d in c.statics)a[d]=c.statics[d];for(d in c.prototypes)a.prototype[d]=c.prototypes[d];return a};a.extendClass=function(b,c,e){var f=d[b].classConstructor,g=d[c].classConstructor;a.__extend(f,g);f.__extend__=function(a,b){f.__super__.constructor.apply(a,b)};e&&e.call(this);return f};m=function(c){function e(){var f=d[c];if(!f)return;f.ready=!0;for(var g=0;g<f.size;g++)d[f.imports[g]]?d[f.imports[g]].loadID>f.loadID&&d[f.imports[g]].ready!==!0&&(f.ready=!1):f.ready=!1;if(f.ready===!0&&d[c]&&d[f.superClass]){a.extendClass(c,f.superClass);n(f.className);f.callback&&f.callback.call(a,null)}else b.setTimeout(e,10)}e()};a.hasClass=function(a){try{if(d[a].ready===!0&&d[d[a].superClass].ready===!0)return!0}catch(b){}return!1};k=function(c,d){function e(){for(var f=0;f<c.length;f++){if(a.hasClass(c[f])===!1)return b.setTimeout(e,25);d&&d.call(a,null)}}e()};l=function(a,b){var c,d=a.length;for(c=0;c<d;c++)if(a[c]===b)return!0;return!1};h=a.include=function(b,d,e,f,h){b=b.trim();var k=b,l=i("script",{"data-includemodule":k});if(l)if(f)l.parentNode.removeChild(l);else if(d)return d.call(a,null);if(c[k]===!0&&d)return d.call(a,null);var m=j("script",{"class":"script-includemodule","data-includemodule":k,type:"text/javascript"});h||(h=!0);!b.endsWith(".js")&&a.BASE_PATH!==""&&(b=a.BASE_PATH+b+".js");if(!a.CACHE){b.indexOf("?")!==-1?b+="&":b+="?";b+="t="+(new Date).getTime()}g("GET",b,function(b){if(f===!0){h&&(m.text=b);d&&d.call(a,b)}else if(b.indexOf(" class ")!==-1){d&&d.call(a,b);console.log(k);m.text=a.parseClass(b)}else{if(h){m.text=b;b.indexOf(a.NAME+".defineClass(")===-1&&n(k)}d&&d.call(a,b)}},function(b){m.parentNode.removeChild(m);e&&e.call(a,b)})};n=function(a){d[a]||(d[a]={});d[a].ready=!0};n("SuperClass");d.SuperClass.classConstructor=f;j=function(a,b){var c=document.createElement(a);for(var d in b)d!=="indexOf"&&c.setAttribute(d,b[d]);document.getElementsByTagName("head").item(0).appendChild(c);return c};i=function(a,b){var c=document.getElementsByTagName(a),d=!1,e;for(var f=0;f<c.length;f++){d=!0;for(var g in b)if(g!=="indexOf"){e=c[f].getAttribute(g);if(!e||e.toString()!==b[g].toString())d=!1}if(d===!0)return c[f]}return!1};g=function(a,c,d,e){var f=!1;if(b.XMLHttpRequest&&!b.ActiveXObject)try{f=new XMLHttpRequest}catch(g){f=!1}else if(b.ActiveXObject)try{f=new b.ActiveXObject("Msxml2.XMLHTTP")}catch(h){try{f=new b.ActiveXObject("Microsoft.XMLHTTP")}catch(i){f=!1}}if(!f){e("Your Browser does not Support Ajax Requests");return!1}f.onreadystatechange=function(){if(f.readyState.toString()==="4"){f.status.toString()==="200"||f.status.toString()==="0"?d(f.responseText):e("There was a problem retrieving the XML data:\n"+f.statusText);f=null}};f.open(a,c,!0);f.send()};a.parseClass=a.parse=function(a){a instanceof Array||(a=[a]);var b="";for(var c=0;c<a.length;c++)b+=o(a[c]);return b};var q=function(a){this.string=a;this.pkg=null;this.imports=[];this.includes=[];this.styles=[];this.constructorFct=null;this.className=null;this.superClass=null;this.qualifiedClassName=null;this.publicFct=[];this.privateFct=[];this.privateVar=[];this.publicVar=[];this.superVar=[];this.publicStaticFct=[];this.publicStaticVar=[];this.privateStaticFct=[];this.privateStaticVar=[];this.string=this.string.replace(/([\/]{2}[^\n]*)|([\n]{1,}[\/]{2}[^\n]*)/g,"");this.string=this.string.replace(/\/\*([\s\S]*?)\*\//g,"");this.string=this.string.replace(/static public/g,"public static");this.string=this.string.replace(/static private/g,"private static");this.string=this.string.replace(/const /g,"var ");var b;this.isStaticClass=this.string.indexOf("public static class")>=0,this.hasSuperClass=this.string.indexOf(" extends ")>=0,this.hasPackage=this.string.indexOf("package ")>=0;var c=this.isStaticClass===!0?"public static class":"public class";this.pkg=this.fetchResource("#package");while(this.string.indexOf("#import")>=0)this.imports.push(this.fetchResource("#import").replace(/\./g,"/"));while(this.string.indexOf("#include")>=0)this.includes.push(this.fetchResource("#include"));while(this.string.indexOf("#style")>=0)this.styles.push(this.fetchResource("#style"));var d="",e="";while(this.string.indexOf("#use")>=0){e=this.fetchResource("#use");d=e.substring(e.lastIndexOf("."));this.string=this.string.replace(new RegExp("new?"+d,"g"),"new "+e);this.string=this.string.replace(new RegExp("extends?"+d,"g"),"extends "+e)}this.string=this.string.trim();this.className=this.string.substring(0,this.string.indexOf(this.hasSuperClass?"extends":"{")).replace(c,"").trim().replace(/\n/g,"");this.superClass=this.string.substring(this.string.indexOf("extends"),this.string.indexOf("{")).replace("extends","").trim();this.qualifiedClassName=this.hasPackage?this.pkg+"."+this.className:this.className;this.hasSuperClass||(this.superClass="SuperClass");this.string=this.string.substring(this.string.indexOf("{")+1,this.string.lastIndexOf("}"));this.constructorFct=this.parseFunction("public",this.className);var f=this.constructorFct.found===!0&&this.hasSuperClass===!0;while(this.string.indexOf("public static var ")>=0)this.publicStaticVar.push(this.parseVar("public static"));while(this.string.indexOf("public static function ")>=0)this.publicStaticFct.push(this.parseFunction("public static"));while(this.string.indexOf("private static var ")>=0)this.privateStaticVar.push(this.parseVar("private static"));while(this.string.indexOf("private static function ")>=0)this.privateStaticFct.push(this.parseFunction("private static"));while(this.string.indexOf("public var ")>=0)this.publicVar.push(this.parseVar("public"));while(this.string.indexOf("private var ")>=0)this.privateVar.push(this.parseVar("private"));while(this.string.indexOf("super var ")>=0)this.superVar.push(this.parseVar("super"));while(this.string.indexOf("public function ")>=0)this.publicFct.push(this.parseFunction("public"));while(this.string.indexOf("private function ")>=0)this.privateFct.push(this.parseFunction("private"));this.string=this.string.trim().replace(/\n/g,"");if(this.string!=="")throw new Error("Error while parsing Class  > "+this.qualifiedClassName+" <");return this};q.prototype.toString=function(){return this.string};q.prototype.valueOf=function(){return this.string};q.prototype.parseFunction=function(a,b){var c={};c.body="";c.args="";c.name="";c.str="";c.found=!1;var d=a+" function",e=this.string.indexOf(d+(b?" "+b:""));if(e===-1)return c;var f=this.string.substring(e),g=f.substring(20).indexOf("public ")+20,h=f.substring(20).indexOf("private ")+20,i=f.substring(20).indexOf("static ")+20;g<=20&&(g=Number.MAX_VALUE||Math.pow(2,50));h<=20&&(h=Number.MAX_VALUE||Math.pow(2,50));i<=20&&(i=Number.MAX_VALUE||Math.pow(2,50));var j=Math.min(g,h,i,f.lastIndexOf("}")+1);f=f.substring(0,j);c.str=f;c.args=f.substring(f.indexOf("(")+1,f.indexOf(")")).trim();c.body=f.substring(f.indexOf("{")+1,f.lastIndexOf("}"));c.name=f.substring(0,f.indexOf("(")).replace(d,"").trim();c.found=!0;this.string=this.string.replace(c.str,"");return c};q.prototype.parseVar=function(a,b){var c={};c.value="";c.name="";c.str="";c.found=!1;var d=a+" var",e=this.string.indexOf(d+(b?" "+b:"")),f=this.string.substring(e),g=f.indexOf(";")+1;if(e===-1)return c;var h=f.substring(0,g),i=h.indexOf("=")!==-1;c.str=h;c.name=(i===!1?h:h.substring(0,h.indexOf("="))).replace("=","").replace(";","").replace(d,"").trim();c.value=(i===!1?"":h.substring(h.indexOf("="))).replace("=","").replace(";","").trim();c.found=!0;c.value===""&&(c.value="null");this.string=this.string.replace(c.str,"");return c};q.prototype.fetchResource=function(a){var b=this.string.indexOf(a);if(b===-1)return"";var c=this.string.substring(b);c=c.substring(0,c.indexOf(";")+1);this.string=this.string.replace(c,"");return c.replace(a,"").replace(";","").replace(/\'/g,"").replace(/\"/g,"").trim()};o=function(b){b=b.replace(new RegExp("\\$","g"),"__DOLLAR__");var c,d,e="",f=new q(b),g=f.privateVar.concat(f.privateFct),h=f.publicVar.concat(f.publicFct),i=[],j=[];for(c=0;c<f.imports.length;c++)i.push("'"+f.imports[c].replace(/\./g,"/")+"'");for(c=0;c<f.includes.length;c++)i.push("'"+f.includes[c]+"'");if(f.pkg!==""){var k=f.pkg.split("."),l="";for(c=0;c<k.length;c++){c!==0&&(l+=".");l+=k[c];e+="if (!"+l+") "+(c===0?"var ":"")+l+" = {};\n"}e+="\n"+f.pkg+"."}else e+="var ";e+=f.className+" = (function () {";e+='"use strict";';for(c=0;c<f.privateStaticFct.length;c++){e+="var "+f.privateStaticFct[c].name+" = function("+f.privateStaticFct[c].args+") {";e+=f.privateStaticFct[c].body;e+="};"}for(c=0;c<f.privateStaticVar.length;c++)e+="var "+f.privateStaticVar[c].name+" = "+f.privateStaticVar[c].value+";";for(c=0;c<f.publicVar.length;c++)f.publicVar[c].value!=="null"&&(e+=f.className+".prototype."+f.publicVar[c].name+" = "+f.publicVar[c].value+";");e+="function "+f.className+"("+f.constructorFct.args+") {";e+=f.className+".__super__.constructor.apply(this, arguments);";e+="var self = this.self;";e+="var priv = self.priv;";f.isStaticClass&&(e+=f.className+".instance = this;");for(c=0;c<f.privateVar.length;c++)e+="priv."+f.privateVar[c].name+" = "+f.privateVar[c].value+";";for(c=0;c<f.publicVar.length;c++);for(c=0;c<f.privateFct.length;c++){e+="priv."+f.privateFct[c].name+" = function("+f.privateFct[c].args+") {";e+=f.privateFct[c].body;e+="};"}for(d=0;d<g.length;d++);e+=f.constructorFct.body;e+="return this;";e+="}";for(c=0;c<f.publicFct.length;c++){for(d=0;d<g.length;d++);e+=f.className+".prototype."+f.publicFct[c].name+" = function("+f.publicFct[c].args+"){";e+="var self = this.self;";e+="var priv = this.priv;";e+=f.publicFct[c].body;e+="};"}for(c=0;c<f.publicStaticVar.length;c++)e+=f.className+"."+f.publicStaticVar[c].name+" = "+f.publicStaticVar[c].value+";";for(c=0;c<f.publicStaticFct.length;c++){e+=f.className+"."+f.publicStaticFct[c].name+" = function("+f.publicStaticFct[c].args+"){";e+=f.publicStaticFct[c].body;e+="};"}e=e.replace(/\s\(/g,"(");e=e.replace(/\(\s\)/g,"()");for(c=0;c<f.publicFct.length;c++){e=e.replace(new RegExp("this."+f.publicFct[c].name+"\\(","g"),"self."+f.publicFct[c].name+".call(self,");e=e.replace(new RegExp("\\bthis."+f.publicFct[c].name+"\\b","g"),"self."+f.publicFct[c].name+".bind(self)")}for(c=0;c<f.superVar.length;c++)e=e.replace(new RegExp("super."+f.superVar[c].name,"g"),"self."+f.superVar[c].name);for(c=0;c<f.publicVar.length;c++)e=e.replace(new RegExp("this."+f.publicVar[c].name,"g"),"self."+f.publicVar[c].name);for(c=0;c<g.length;c++)e=e.replace(new RegExp("this."+g[c].name,"g"),"self.priv."+g[c].name);for(c=0;c<f.styles.length;c++)e+=a.NAME+".style('"+f.styles[c]+"');";e+=a.NAME+".defineClass({";e+="className: '"+f.qualifiedClassName.replace(/\./g,"/")+"'";e+=", classConstructor: "+f.className;e+=", superClass: '"+f.superClass.replace(/\./g,"/")+"'";e+=", imports: ["+i.join(", ")+"]";e+=", plugins: ["+j.join(", ")+"]";a.DEFINES_CLASSES||(e+=", skipImports: true");f.isStaticClass&&(e+=",callback: function(){ new "+f.className+"(); }");e+="});\n";e+="return "+f.className+";";e+="})();";e=e.replace(/super\s\(/g,"super(");e=e.replace(/super\(\s\)/g,"super()");e=e.replace(/super\(\);/g,"");e=e.replace(/parent\./g,"super.");e=e.replace(/super\./g,f.className+".__super__.");e=e.replace(/(__super__\.)+([\s\S]*?\()/g,"$&.call(self,");e=e.replace(/apply\(.call\(self,/g,"apply(");e=e.replace(/\(\.call\(self/g,".call(self");e=e.replace(/function\.call\(self,/g,"function(");e=e.replace(/for\.call\(self,/g,"for (");e=e.replace(/self,\)/g,"self)");e=e.replace(/__DOLLAR__/g,"$");e=e.replace(/dispatchEvent/g,"triggerEvent");e=e.replace(/addEventListener/g,"signalConnect");e=e.replace(/removeEventListener/g,"unconnectSignal");e=e.replace(/==/g,"===");e=e.replace(/====/g,"===");e=e.replace(/====/g,"===");e=e.replace(/!=/g,"!==");e=e.replace(/!===/g,"!==");e=e.replace(/!===/g,"!==");if(a.MINIFY_JS){e=e.replace(/function /g,";function ");e=e.replace(/\n|\t/g,"");while(e.indexOf(";;")>=0)e=e.replace(/;;/g,";")}else try{e=js_beautify(e,{indent_size:2,indent_char:" ",preserve_newlines:!1})}catch(m){}return e};if(!b.console||!b.console.log){b.console={};b.console.log=function(){}}Function.prototype.bind||(Function.prototype.bind=function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){return a.apply(c,b.concat(Array.prototype.slice.call(arguments)))}});String.prototype.trim=function(){var a=this.replace(/^\s\s*/,""),b=/\s/,c=a.length;do c--;while(b.test(a.charAt(c)));return a.slice(0,c+1)};String.prototype.endsWith=function(a){return this.substring(this.length-a.length)===a};var r=document.getElementsByTagName("script"),s=null,t,u,v;for(var w=0;w<r.length;w++){t=r[w].getAttribute("data-cache");u=r[w].getAttribute("data-minify");v=r[w].getAttribute("data-dir");t&&t.toString().toLowerCase()==="true"&&(a.CACHE=!0);u&&u.toString().toLowerCase()==="true"&&(a.MINIFY_JS=!0);v&&(a.BASE_PATH=r[w].getAttribute("data-dir"));if(r[w].getAttribute("data-main")){s=r[w].getAttribute("data-main");r[w].getAttribute("data-dir")?a.BASE_PATH=r[w].getAttribute("data-dir"):a.BASE_PATH=s.substring(0,s.lastIndexOf("/")+1);s.substring(s.length-3)!==".js"&&s.indexOf(a.BASE_PATH)===0&&(s=s.substring(a.BASE_PATH.length))}}s&&a.requires(s);return a}({},window);